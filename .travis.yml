language: cpp
addons:
  apt:
    packages:
    - libfreetype6-dev
    - libx11-dev
    - libxrandr-dev
    - libgl1-mesa-dev
    - libudev-dev
    - libopenal-dev
    - libflac-dev
    - libogg-dev
    - libvorbis-dev
matrix:
  include:
  - name: Linux gcc Dynamic
    os: linux
    dist: xenial
    compiler: gcc
  - name: macOS Clang Dynamic
    os: osx
    compiler: clang
    env:
    - CMAKE_FLAGS="-DSFML_DEPENDENCIES_INSTALL_PREFIX=../SFML-install"
before_script:
- git -C $HOME/SFML pull || git clone https://github.com/SFML/SFML.git $HOME/SFML
- mkdir -p SFML-build && mkdir -p SFML-install && cd SFML-build
- cmake $HOME/SFML $CMAKE_FLAGS -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=../SFML-install
- cmake --build . --target install
- cd ..
script:
- mkdir build && cd build
- cmake -DSFML_DIR=$TRAVIS_BUILD_DIR/SFML-install/lib/cmake/SFML ..
- cmake --build .
- cd ..
cache:
  directories:
  - SFML-build
  - SFML-install
  - "$HOME/SFML"
before_deploy:
- zip -r artifacts.zip SFML-build
deploy:
  provider: releases
  api_key:
    secure: oEPcwt63yncsVFDhr/4fNoR8maRqIusNexZBLtyuOf8TMO8t7GoNf2NwTfCx5ICeSihOVtc1aVZvyjovIJoSOzIxSBTBonooL9BRdbaLt53XGbaw9DDj7nYj0LVMG+wL2J/N7iPOWywp99yXOawGa4ArMXz1WwrDh52ExA73vIWKYvNwOmE4JHF76bLON2jUZ1gelIOUjxsQdhXRaClQ9ku230QPbhH/IZ105eHVO+eaJGd/Fuu3+dTZ4oT/FqN+NurSto7k5SfCpb6qlxTHlR0kNA/svQb+P/B4ozeSkSiS31R4ZxmqUjZpKfWln0xT/43kCkCWw/ULRhCqBWIlm7rVySc3SpBC3Pt5nFqf4GgJy3vB24Az2Gr0i6FRZHq2Hkp/ZJZvudPcsEitdbz5KKR/E9QuZNXIEzdEBwksLMn09MxAOjCudSszgijiNs7vCw10YV2tBTKxESTeY6UCW2M1USKxN20UwgO5WWjzo3JrO5y7vCiHoG8Ze5AA8kxvJOR9TzlZk0aP6/LtSWi3nptQ6uCqhvnAJPMji/VFdz1TuyfMNx8ksM0tpe7VhZJPnRGjp63mud4et2YaB8rxmGkwRk9NOn/jaJdrJLvqlZ6RoGcjPlsbIOhU1gIPiBbrgosbqpAXRJrp4ruPhDkw6dzd+tQ9O+EnL3uHRLRyy7k=
  file: artifacts.zip
  skip_cleanup: true
  draft: true
