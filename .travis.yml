language: cpp
addons:
  apt:
    packages:
    - libfreetype6-dev
    - libx11-dev
    - libxrandr-dev
    - libgl1-mesa-dev
    - libudev-dev
    - libopenal-dev
    - libflac-dev
    - libogg-dev
    - libvorbis-dev
matrix:
  include:
  - name: Linux gcc Dynamic
    os: linux
    dist: xenial
    compiler: gcc
  - name: macOS Clang Dynamic
    os: osx
    compiler: clang
    env:
    - CMAKE_FLAGS="-DSFML_DEPENDENCIES_INSTALL_PREFIX=../SFML-install"
before_script:
- git -C $HOME/SFML pull || git clone https://github.com/SFML/SFML.git $HOME/SFML
- mkdir -p SFML-build && mkdir -p SFML-install && cd SFML-build
- cmake $HOME/SFML $CMAKE_FLAGS -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=../SFML-install
- cmake --build . --target install
- cd ..
script:
- mkdir build && cd build
- cmake -DSFML_DIR=$TRAVIS_BUILD_DIR/SFML-install/lib/cmake/SFML ..
- cmake --build .
- cd ..
cache:
  directories:
  - SFML-build
  - SFML-install
  - "$HOME/SFML"
before_deploy:
- zip -r artifacts.zip SFML-build
deploy:
  provider: releases
  api_key:
    secure: GDZq+rPArzl6TGX4v7dhc85o0RwEnaWQAbH59I2LlwKvvrV855vKbUbNBZ5agkL0MhyAi69zbjs444RYYc+f2J8jUYo4DcElil8jQwoDMOSlVN7PDY0iPuH5+dtaGWts0n1XQqFTil4/kpiEYoMXrSGa0O8VySEW521QcyhTVkDaFjMVnesIO4wCOUCtjXNYBB7tL7Jk//KBB+VJ4CA3ciSRbVCYEZGGFUTwR7kAGYXvxP/FKFgqQbhfRei529LNpPLlEL3rDg8ypM+IZ01pW9n/EItBXbZ50eGIvJFhbelStE+yaXEAv0y8XihAUDsa43dYjdfz/xzRUNv73+99TpY82MW5lMWlU/+euCwRQNWW6DzyYuEjs45Wpi/sZt6P1aZeuZkgbYeo1KeqCjz+dXiMlXZT3SEgaFpMRQuqTA6Q4qfLX3iQ+LBU+NwKUl9YDpUM1BZmuXHGt/Y0w5Z0ttRZxXgrSFof4lwf2W2fhvtloQ/czDxCntteYbl6PW3ZBOz2MZHZ/P1z6xrEWRYkOdQft3UhpqMRMgYDTAGOYYciNEKe/D0Np7JFMzt860yL7r5kUefSwftvoWxtYChNEpXCCc/mIzW3OB+d8TL0ZjHzp1fLQitj5f0nPYMKHw41m+RpE6r3nUI8uqUrS3xQdYGaNFBDIvyd3TADVBKwYq4=
  file: artifacts.zip
  on:
    repo: SamuelGallay/BrownianMotion
